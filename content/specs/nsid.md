---
title: ネームスペース識別子（NSID）
summary: グローバルな意味論的IDのための仕様。
---

# ネームスペース識別子（NSID）
ネームスペース識別子（NSID）は、レコード、XRPCエンドポイントなどのLexiconスキーマを参照するために使用されます。

NSIDの基本的な構造とセマンティクスは、逆ドメイン名順の完全修飾ホスト名に続いてシンプルな名前です。ホスト名部分は**ドメイン権威（domain authority）** であり、最後のセグメントは**名前（name）** です。

### NSID構文

Lexicon文字列タイプ：`nsid`

NSIDのドメイン権威部分は、セグメントの順序が逆になった有効なハンドルでなければなりません。それに続く名前セグメントはASCIIキャメルケース文字列でなければなりません。

例えば、`com.example.fooBar`は構文的に有効なNSIDであり、`com.example`がドメイン権威であり、`fooBar`が名前セグメントです。

構文規則の包括的なリストは次の通りです：

- 全体のNSID：
    - ASCII文字のみを含む必要があります
    - ドメイン権威と名前をASCIIピリオド文字（`.`）で区切る必要があります
    - 少なくとも3つのセグメントを持っている必要があります
    - 最大で合計317文字までの長さになります
- ドメイン権威：
    - ピリオド（`.`）で区切られたセグメントで構成されています
    - 最大253文字（ピリオドを含む）で、少なくとも2つのセグメントを含んでいる必要があります
    - 各セグメントは1文字以上、最大63文字（ピリオドを含まない）まででなければなりません
    - 許可される文字はASCIIの文字（`a-z`）、数字（`0-9`）、ハイフン（`-`）です
    - セグメントはハイフンで始まるか終わることはできません
    - 最初のセグメント（トップレベルドメイン）は数字で始まることはできません
    - ドメイン権威は大文字小文字を区別しないため、小文字に正規化されるべきです（すなわち、ASCIIの `A-Z` を `a-z` に正規化）
- 名前：
    - 少なくとも1文字、最大63文字でなければなりません
    - 許可される文字はASCIIの文字のみです（`A-Z`、`a-z`）
    - 数字とハイフンは許可されていません
    - 大文字小文字を区別し、正規化してはいけません

NSIDの参照用の正規表現は以下の通りです：

```
/^[a-zA-Z]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(\.[a-zA-Z]([a-zA-Z]{0,61}[a-zA-Z])?)$/
```

### NSID構文のバリエーション

**フラグメント**は、スキーマ内の特定のサブフィールドを参照するために、一部の文脈でNSIDに追加することができます。フラグメントはASCIIハッシュ文字（`#`）でNSIDから分離されます。フラグメント識別子文字列（`#`の後）は、NSIDの最終セグメントと同じ構文制限を持っています：ASCIIアルファベット、1文字以上、制限された長さなど。

NSIDのグループやパターンを参照する際には、末尾にASCIIスター文字（`*`）を追加して「グロブ」文字として使用できます。例えば、`com.atproto.*`は`atproto.com`ドメイン権威の下にある任意のNSIDを参照し、ネストしたサブドメイン（サブ権威）を含みます。独立した`*`は、すべての権威からのすべてのNSIDに一致します。現時点では、単一のスタート文字しか使用できず、それは最後の文字でなければなりません。そして、セグメント名の部分一致は許可されません。これはスタート文字がピリオドに続くか、すべてのNSIDに一致する裸のスターである必要があることを意味します。

### 例

構文的に有効なNSID：

```
com.example.fooBar
net.users.bob.ping
a-0.b-1.c
a.b.c
cn.8.lex.stuff
```

無効なNSID：

```
com.exa💩ple.thing
com.example
```

### 使用および実装ガイドライン

**強く推奨される**ベストプラクティスは、ASCIIアルファベットのみを使用した権威ドメインを使用することです（つまり、数字やハイフンを含まないこと）。これにより、ほとんどのプログラミング言語でクライアントライブラリを生成することが格段に容易になります。

表示、保存、および検証のために全体のNSIDは大文字小文字を区別します。ただし、ケースだけが異なる複数のNSIDを持つことは許されていません。ネームスペース権威は重複と混乱を防ぐ責任があります。実装はNSIDを強制的に小文字に変換してはいけません。

「サブドメイン」を「ドメイン権威」の一部として使用して関連するNSIDを整理することは一般的です。例えば、NSID `com.atproto.sync.getHead` は `sync` セグメントを使用しています。これには `sync.atproto.com` ドメイン全体の制御が必要です。

Lexicon言語のドキュメンテーションは、レコードタイプとXRPCメソッドのNSIDの選択と整理に関するスタイルガイドを提供します。簡単に言うと、レコードは通常、単数形の名詞です。XRPCメソッドは通常「動詞名詞」形式です。

### 可能な将来の変更

NSID構文が最終セグメントでUnicode文字を許容するように緩和される可能性があります。

「グロブ」構文バリエーションは、単一レベルとネストした一致の区別をより明示的にするように変更されるかもしれません。

将来的には「フラグメント」構文バリエーションがネストした参照を許容するように緩和される可能性があります。

現在、「ドメイン権威」の制御を検証する自動化されたメカニズムは存在しません。また、指定されたNSIDのためにLexiconスキーマを取得するための自動化されたメカニズムや、基本ドメインのすべてのNSIDを列挙するためのメカニズムも存在しません。