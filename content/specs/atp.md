---
title: ATプロトコル
summary: 認証済み転送プロトコル（ATプロトコル）の仕様書

---

# ATプロトコル

認証済み転送プロトコル（ATプロトコルまたはatproto）は、オープンソーシャルメディアアプリケーションを構築するための汎用のフェデレーテッドプロトコルです。いくつかの繰り返しテーマと特徴があります：

- 自己認証データとアイデンティティにより、シームレスなアカウント移行とコンテンツの再配布が可能になります。
- 「ビッグワールド」ユースケース向けのデザインで、数十億のアカウントにスケーリングします。
- アプリケーションレイヤのスキーマと集計インフラの委任された権限
- dwebプロトコルファミリーからの既存のデータモデルの再利用とWebプラットフォームからのネットワークプリミティブの再利用

## プロトコル構造

**アイデンティティ：** アカウントコントロールは安定した[DID](/specs/did)識別子に基づいており、これはアカウントに関連する現在のサービスプロバイダの場所と[暗号キー](/specs/cryptography)を素早く解決できます。[ハンドル](/specs/handle)はアカウントのより人間に認識しやすく、変更可能な識別子を提供します。

**データ：** パブリックコンテンツはコンテンツアドレス指定および暗号的に検証可能な[リポジトリ](/specs/repository)に保存されます。データレコードとネットワークメッセージはすべて統一された[データモデル](/specs/data-model)（[IPLD](https://ipld.io/docs/data-model/)、[CBOR](https://en.wikipedia.org/wiki/CBOR)、およびJSON表現）に準拠しています。

**ネットワーク：** HTTPクライアントサーバーおよびサーバーサーバー[API](/specs/xrpc)はレキシコンで説明されており、WebSocket [イベントストリーム](/specs/event-stream)も同様です。[AT URI](/specs/at-uri-scheme)によりネットワーク全体で個々のレコードを参照できます。個人データサーバー（PDS）はネットワーク上のアカウントの信頼できるエージェントとして機能し、クライアントネットワークリクエストをルーティングし、リポジトリをホストします。リレー（以前はBig Graph ServiceまたはBGSと呼ばれていました）は多くのリポジトリをクロールし、統一されたイベントファイアホースを出力します。

**アプリケーション：** atprotoで構築されたアプリケーションのためのAPIとレコードスキーマは[レキシコン](/specs/lexicon)で指定され、[名前空き識別子](/specs/nsid)（NSID）によって参照されます。アプリケーション固有の集計（検索など）はアプリケーションビューサービス（App View）によって提供されます。クライアントにはモバイルアプリ、デスクトップソフトウェア、またはWebインターフェースが含まれます。

ATプロトコル自体は、フォローやアバターのような一般的なソーシャルメディアの慣習を指定していません。これらはアプリケーションレベルのレキシコンに任せています。 `com.atproto.*`レキシコンはアカウントのサインアップやログインなどの共通のAPIを提供します。これらはATプロトコル自体の一部と見なすことができますが、必要に応じて拡張または置換することもできます。BlueskyはATプロトコルの上に構築されたマイクロブログソーシャルアプリで、`app.bsky.*`ネームスペースの下にあるレキシコンを使用しています。

atprotoはIPFSエコシステムからいくつかのフォーマットと仕様を借りています（IPLDやCIDなど）。ただし、atprotoデータはIPFSネットワークに保存する必要はなく、atprotoのリファレンス実装はIPFSネットワークを使用していませんが、他のatproto実装が採用するのは理にかなった技術であるかもしれません。

## プロトコルの拡張とアプリケーション

ATプロトコルは、第三者アプリケーションの開発に対する柔軟性と相互運用性をバランスさせるために最初から設計されました。

コアプロトコルの拡張メカニズムは、独立した名前空間の下で新しいレキシコンの開発です。レキシコンは新しいリポジトリレコードスキーマ（NSIDによってコレクションに格納される）、新しいHTTP APIエンドポイント、および新しいイベントストリームエンドポイントとメッセージタイプを宣言できます。また、新しいアプリケーションには新しいネットワーク集約サービス（"AppViews"）とクライアントアプリ（モバイルアプリまたはWebインターフェースなど）が必要とされることが期待されています。

第三者はレキシコンとレコードデータを名前空間全体で再利用することが期待されています。たとえば、新しいアプリケーションは`app.bsky.*`レキシコンで指定されたソーシャルグラフレコードを基に構築できますが、これは`bsky.app`権限によって制御されるスキーマに準拠している限りです。

個々のレキシコン名前空間のガバナンス構造は柔軟です。ボランティアコミュニティ、企業、コンソーシアム、学術研究者、資金提供された非営利団体などによって開発および維持される可能性があります。

## 不足しているものは何ですか？

これらの仕様は、Blueskyのリファレンス実装で実装されている詳細のほとんどをカバーしています。ただし、そのリファレンス実装とこれらの仕様の両方でいくつかの重要な部分がまだ最終的には確定していません。

**アカウント移行：** アイデンティティおよびリポジトリシステムは、非協力的なサービスプロバイダの存在に影響を与えずに、アカウントをPDSサービスプロバイダ間で簡単に移行できるように設計されました。まだ詳細が確定していない部分があります：オプションのPDS-to-PDSリポジトリ転送、転送グレース期間中のダウンストリームの動作、ネットワークの乱用を防ぐためのレート制限規範、ブロブ移行など。

**リポジトリ同期：** リポジトリのコミットスキーマにはリビジョンフィールドがあり、`com.atproto.sync.*`レキシコンはこれらを`since`パラメータを介して参照してリポジトリコンテンツの部分取得を行うことができます。このメカニズムはほぼ確定していますが、詳細はまだここに指定されていません。

**リポジトリイベントストリーム：** `com.atproto.sync.subscribeRepos`サブスクリプションレキシコンはプロトコルの中核的な部分であり、詳細をさらに詳しく説明する必要があります。これには「コミット」メッセージタイプのセマンティクスが含まれ、これには新しいリポジトリブロックの「CARスライス」と操作リストが含まれます。

**ブロブエクスポート：** ブロブ（または画像）のエクスポートと同期方法の詳細。ブロブはリポジトリに保存されていませんが、リポジトリレコードからリンクされています。

**モデレーションプリミティブ：** 分散モデレーションのための「ラベル」アーキテクチャはリファレンス実装があり、ほとんどがレキシコン（アプリケーションレベル）で指定されていますが、統一されたシステムとしての詳細はまだ記述されていません。同様に、モデレーションレポートの処理とインフラレベルのテイクダウンを行うための`com.atproto.admin.*`ルートはレキシコンで指定されていますが、これも詳細に記述されるべきです。

**レキシコンの解決：** 特定のタイプ名（NSID）に対するレキシコンスキーマ定義ファイルを自動的に検索して取得する方法

## 今後の作業

個々の仕様書には小規模な変更が記載されていますが、いくつかの大規模な変更がプロトコル全体にまたがっています。

**サードパーティの認証と承認：** サービス全体での認証（atproto内でのサービス間）およびエコシステム外での「atprotoでログイン」のユースケースのために、より強力な認証システムを提供する意図があります。これには既存の認証規格も組み込まれる可能性が高いです。

**非公開コンテンツ：** プライベートグループや1対1の通信のメカニズムが、プロトコル開発の第二段階全体を形成します。これには「プライベートアカウント」、ダイレクトメッセージ、暗号化データなどの基本要素が含まれます。既存のプロトコルプリミティブを使用して暗号化またはプライベートコンテンツを単純に「取り付ける」ことはお勧めしません。

**プロトコルガバナンスと形式的な標準プロセス：** 現在の開発の焦点はリファレンス実装を介したすべてのコアプロトコル機能のデモンストレーション、オープンな連邦を含むことです。その後の段階では、低レベルのプロトコルを安定化させ、IETFやW3Cなどの標準機関を通じて独立したレビューと修正のために仕様を提出する意図があります。
